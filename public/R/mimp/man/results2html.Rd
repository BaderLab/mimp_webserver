\name{results2html}
\alias{results2html}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Display MIMP results as html
}
\description{
This function displays results generated by the \code{mimp} function in the browser for easier navigation
}
\usage{
results2html(x)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{x}{
Data frame generated by the \code{mimp} function
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (x) 
{
    logo.dir = file.path(BASE_DIR, "html", "images", "logos")
    x$wt.score = signif(x$wt.score, 3)
    x$mt.score = signif(x$mt.score, 3)
    x$pwm = gsub("-", "_", x$pwm)
    n_gain = sum(x$effect == "Loss")
    n_loss = sum(x$effect == "Gain")
    n_mut = nrow(unique(x[, c("gene", "mut")]))
    lines = sapply(1:nrow(x), function(i) {
        r = x[i, ]
        d = r$mut.dist
        seq = sprintf("\%s<br>\%s", .htmlSeq(r$flank.wt, d), .htmlSeq(r$flank.mt, 
            d))
        scr = sprintf("\%s<br>\%s", r$wt.score, r$mt.score)
        logo = file.path(logo.dir, paste0(r$pwm, ".png"))
        t = sprintf("<img src=\"\%s\" class=\"logo\" alt=\%s/>", 
            logo, r$pwm)
        if (r$effect == "Loss") {
            eff = "<a class=\"loss\">Loss</a>"
        }
        else {
            eff = "<a class=\"gain\">Gain</a>"
        }
        gene = sprintf("<a target=\"_blank\" class=\"gene-link\" href=\"http://www.genecards.org/cgi-bin/carddisp.pl?gene=\%s\">\%s</a>", 
            r$gene, r$gene)
        sprintf("<tr> <td>\%s</td> <td>\%s</td> <td>\%s</td> <td>\%s</td> <td class=\"sequence\">\%s</td> <td>\%s</td> <td>\%s</td> <td>\%s</td> <td>\%s</td> </tr>", 
            gene, r$pos, r$mut, r$mut.dist, seq, r$wt.score, 
            r$mt.score, eff, t)
    })
    tt = "<div id=\"\%s\" style=\"display:none\">\%s</div>"
    lines = append(lines, c(sprintf(fmt = tt, "n_mut", n_mut), 
        sprintf(fmt = tt, "n_gain", n_gain), sprintf(fmt = tt, 
            "n_loss", n_loss)))
    save = file.path(BASE_DIR, "html", "MIMP_results.html")
    zz <- file(save, "w")
    tt = readLines(file.path(BASE_DIR, "html", "index.html"))
    ind = grep("<DATA>", tt)
    writeLines(tt[1:(ind - 1)], con = zz, sep = "\n")
    writeLines(lines, con = zz, sep = "\n")
    writeLines(tt[(ind + 1):length(tt)], con = zz, sep = "\n")
    close(zz)
    browseURL(save)
  }
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
